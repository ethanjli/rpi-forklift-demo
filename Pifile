# Note: the env vars used in the FROM directive and TO directives are not substituted by Pimod, so
# they must instead be substituted by GitHub Actions:
FROM @@BASE_IMAGE@@
TO @@OUTPUT_IMAGE_NAME@@.img

PUMP 8G

# TODO: initialize username and password
# TODO: set locale (time zone and keyboard layout)

ENV DEBIAN_FRONTEND noninteractive

INSTALL os-setup /tmp/os-setup
RUN su - pi -s bash -c '\
  echo $HOME && \
  /tmp/os-setup/setup.sh && \
  /tmp/os-setup/cleanup.sh \
'
